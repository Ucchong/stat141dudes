---
title: "STA108 Final Project"
author: "Madalyn Papenfuss, Sung Ah Lee, Chang, Brian"
date: "2023-12-01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

```

```{r}
data = read.csv("heart_disease_health_indicators_BRFSS2015.csv")
# colnames = HeartDiseaseorAttack, HighBP, HighChol, CholCheck, BMI, Smoker, Stroke, Diabetes, PhysActivity, Fruit, Veggies, HvyAlcoholConsump, AnyHealthcare, NoDocbcCost, GenHlth, MentHlth, PhysHlth, DiffWalk
head(data)
#col_name = c(1,2,3,5,6,7,8,9)
#data = data[,col_name]
#interested in col: HeartDiseaseorAttack, HighBP, HighChol, BMI, Smoker, Stroke, Diabetes, PhysActivity (first 8 col)
```

```{r}
# creating test and train data
set.seed(13)
train_index <- sample(1:nrow(data), 0.5 * nrow(data))  # 50% for training 
train_data <- data[train_index, ]
test_data <- data[-train_index, ]
head(test_data)
max(test_data$Income)
#WILL CHANGE TO K-FOLD cv

```

```{r}
# Using train_data to create our model
logreg=glm(HeartDiseaseorAttack ~ HighBP + HighChol + CholCheck + BMI + Smoker + Stroke + Diabetes + PhysActivity + Fruits + Veggies + HvyAlcoholConsump + AnyHealthcare + NoDocbcCost + GenHlth + MentHlth + PhysHlth + DiffWalk + Sex + Age + Education + Income, data = train_data, family = binomial) #which variables are significant?

logregBMI = glm(HeartDiseaseorAttack ~ HighBP +BMI, data = train_data, family = binomial)
summary(logregBMI)

summary(logreg)
#significant variables = 
## (Intercept)       -7.7828371  0.1424933 -54.619  < 2e-16 ***
# HighBP             0.5238218  0.0249983  20.954  < 2e-16 ***
# HighChol           0.6099891  0.0231388  26.362  < 2e-16 ***
# CholCheck          0.4037878  0.0901655   4.478 7.52e-06
# Smoker             0.3481076  0.0221743  15.699  < 2e-16 ***
# Stroke             0.9670444  0.0349096  27.701  < 2e-16 ***
# Diabetes           0.1414394  0.0126559  11.176  < 2e-16 ***
# HvyAlcoholConsump -0.2474005  0.0546589  -4.526 6.00e-06 ***
# NoDocbcCost        0.2767829  0.0376501   7.351 1.96e-13 ***
# GenHlth            0.4770993  0.0133503  35.737  < 2e-16 ***
# DiffWalk           0.3139449  0.0272785  11.509  < 2e-16 ***
# Sex                0.7463776  0.0225979  33.029  < 2e-16 ***
# Age                0.2633630  0.0051587  51.052  < 2e-16 ***
# Income            -0.0461303  0.0059884  -7.703 1.33e-14 ***
logreg2 = glm(HeartDiseaseorAttack ~ HighBP + HighChol + CholCheck + Smoker + Stroke + Diabetes + HvyAlcoholConsump + NoDocbcCost + GenHlth + DiffWalk + Sex + Age + Income, data = train_data, family = binomial)
summary(logreg2)
```


```{r}
# using logreg2 to predict test_data
prediction <- predict(logreg2, test_data, type = "response")
predicted_classes <- ifelse(prediction > 0.5, 1, 0)
max(prediction)
unique(predicted_classes)
confusion_matrix <- print(table(test_data$HeartDiseaseorAttack, predicted_classes))
confusion_matrix <- table(predicted_classes, test_data$HeartDiseaseorAttack);confusion_matrix
print(sum(diag(confusion_matrix)) / sum(confusion_matrix))
```

```{r}
#plotting in R
logreg=glm(HeartDiseaseorAttack ~ HighBP + HighChol + CholCheck + BMI + Smoker + Stroke + Diabetes + PhysActivity + Fruits + Veggies + HvyAlcoholConsump + AnyHealthcare + NoDocbcCost + GenHlth + MentHlth + PhysHlth + DiffWalk + Sex + Age + Education + Income, data = train_data, family = binomial)
logreg2 = glm(HeartDiseaseorAttack ~ HighBP + HighChol + CholCheck + Smoker + Stroke + Diabetes + HvyAlcoholConsump + NoDocbcCost + GenHlth + DiffWalk + Sex + Age + Income, data = train_data, family = binomial)

#HIGH BP
barplot(table(train_data$HighBP), col = c("red", "blue"), beside = T, names.arg = c("No High BP", "Yes High BP"), main = "High Blood Pressure Distribution", ylab = "Frequency")
#HIGH CHOL
barplot(table(train_data$HighChol), col = c("red", "blue"), beside = T, names.arg = c("No High Chol", "Yes High Chol"), main = "High Cholestrol Distribution", ylab = "Frequency")
# CholCheck
barplot(table(train_data$CholCheck), col = c("red", "blue"), beside = T, names.arg = c("No Chol Check", "Yes Chol Check"), main = "Chol Check within 5 years Distribution", ylab = "Frequency")
#Smoker
barplot(table(train_data$Smoker), col = c("red", "blue"), beside = T, names.arg = c("No Smoker", "Smoker"), main = "Smoker Distribution", ylab = "Frequency")
#Stroke
barplot(table(train_data$Stroke), col = c("red", "blue"), beside = T, names.arg = c("No Stroke", "Yes Stroke"), main = "Stroke Distribution", ylab = "Frequency")
# Diabetes
barplot(table(train_data$Diabetes), col = c("red", "blue"), beside = T, names.arg = c("No Diabetes", "Yes Type 2 Diabetes", "Yes Type 1 Diabetes"), main = "High Diabetes Distribution", ylab = "Frequency")
# HvyAlcoholConsump
barplot(table(train_data$HvyAlcoholConsump), col = c("red", "blue"), beside = T, names.arg = c("No Heavy Alcohol Consump", "Yes Heavy Alcohol Consump"), main = "Heavy Alcohol Consump Distribution", ylab = "Frequency")
# NoDocbcCost
barplot(table(train_data$NoDocbcCost), col = c("red", "blue"), beside = T, names.arg = c("No - No Doc bc Cost", "Yes - No Doc bc Cost"), main = "No Doc bc Cost Distribution", ylab = "Frequency")
# GenHlth
barplot(table(train_data$GenHlth), col = c("red", "blue"), beside = T, names.arg = c("1 - GenHlth", "2 - GenHlth", "3 - GenHlth", "4 - GenHlth", "5 - GenHlth"), main = "General Health Distribution", ylab = "Frequency")
# DiffWalk
barplot(table(train_data$DiffWalk), col = c("red", "blue"), beside = T, names.arg = c("DiffWalk", "Yes DiffWalk"), main = "DiffWalk Distribution", ylab = "Frequency")
# Sex
barplot(table(train_data$Sex), col = c("red", "blue"), beside = T, names.arg = c("Male", "Female"), main = "Sex Distribution", ylab = "Frequency")
# Age
barplot(table(train_data$Age), col = c("red", "blue"), beside = T, names.arg = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13"), main = "Age Distribution", ylab = "Frequency")
# Income
barplot(table(train_data$Income), col = c("red", "blue"), beside = T, main = "Income Distribution", ylab = "Frequency")
unique(data$Age)

```

```{r}

#age of people with heart attacks vs age of people without heart attacks
cols = names(df) %in% c('points')
data0 = subset(data, HeartDiseaseorAttack<1 )
head(data0)


data1 = subset(data, HeartDiseaseorAttack >= 1 )
head(data1)



boxplot(data1$Age, data0$Age)
max(data1$Age)
plot(test_data$BMI, test_data$Age)

#INCOME of people with heart attacks vs INCOME of people without heart attacks

#GEN Health of people with heart attacks vs GEN Health of people without heart attacks
```
```{r}
cor_matrix = cor(data[,c("Education", "Income")]);cor_matrix
cor_matrix = cor(data[,c("GenHlth", "MentHlth", "PhysHlth")]);cor_matrix
```


